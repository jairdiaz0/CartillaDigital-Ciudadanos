<div class="container-fluid">
  <h1 class="text-center"> Cartilla de vacunacion del Adulto Mayor (de 60 años o más) </h1>
  <table border="3">
    <thead>
      <tr>
        <th class="col"> Vacuna </th>
        <th class="col"> Dosis </th>
        <th class="col"> Información</th>
      </tr>
    </thead>
    <tbody>
      <tr class="fila">
        <td rowspan="3" class="col d-table-cell" data-bs-toggle="modal" data-bs-target="#informacion"
          (click)="info('Neumocócica Polisacárica', 'Neumonia por neumococo')">
          Neumocócica Polisacárica
        </td>
        <td class="col d-table-cell" data-bs-toggle="modal" data-bs-target="#dosis"
          (click)="dosis('Dosis Neumocócica Polisacárica Única', 'Edad oprtuna:A partir de los 65 años')">
          Única
        </td>
        <td class="col text-danger" *ngIf="!CART_AMY.Neumococica_unica">
          <button class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#qrModal" (click)="applyVaccine('Neumococica_unica')">
            Aplicar
          </button>
        </td>
        <td class="col text-danger" *ngIf="CART_AMY.Neumococica_unica">
          <button class="btn btn-outline-success " data-bs-toggle="modal" data-bs-target="#seleccion"
            (click)="seleccionar(CART_AMY.Neumococica_unica)">
            Ver información
          </button>
        </td>
      </tr>
      <tr class="fila">
        <td class="col d-table-cell" data-bs-toggle="modal" data-bs-target="#dosis"
          (click)="dosis('Dosis Neumocócica Polisacárica Personas con factores de riesgo', 'Edad oprtuna:60 a 64 años de edad')">
          Dosis inicial - Personas con factores de riesgo
        </td>
        <td class="col text-danger" *ngIf="!CART_AMY.Neumococica_inicial">
          <button class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#qrModal" (click)="applyVaccine('Neumococica_inicial')">
            Aplicar
          </button>
        </td>
        <td class="col text-danger" *ngIf="CART_AMY.Neumococica_inicial">
          <button class="btn btn-outline-success " data-bs-toggle="modal" data-bs-target="#seleccion"
            (click)="seleccionar(CART_AMY.Neumococica_inicial)">
            Ver información
          </button>
        </td>
      </tr>

      <tr class="fila">
        <td class="col d-table-cell" data-bs-toggle="modal" data-bs-target="#dosis"
          (click)="dosis('Dosis Neumocócica Polisacárica Revacunación única', 'Edad oprtuna:Cinco años después de la dosis inicial')">
          Revacunación única - Personas con factores de riesgo
        </td>
        <td class="col text-danger" *ngIf="!CART_AMY.Neumococica_revacunacion">
          <button class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#qrModal" (click)="applyVaccine('Neumococica_revacunacion')">
            Aplicar
          </button>
        </td>
        <td class="col text-danger" *ngIf="CART_AMY.Neumococica_revacunacion">
          <button class="btn btn-outline-success " data-bs-toggle="modal" data-bs-target="#seleccion"
            (click)="seleccionar(CART_AMY.Neumococica_revacunacion)">
            Ver información
          </button>
        </td>
      </tr>
      <tr class="fila">
        <td rowspan="4" class="col d-table-cell" data-bs-toggle="modal" data-bs-target="#informacion"
          (click)="info('Td', 'Tetanos y Difteria')">
          Td
        </td>
        <td class="col d-table-cell" data-bs-toggle="modal" data-bs-target="#dosis"
          (click)="dosis('Dosis Td Refuerzo', 'Edad oprtuna:Cada 10 años')">
          Con esquema completo - Refuerzo
        </td>
        <td class="col text-danger" *ngIf="!CART_AMY.Td_refuerzo">
          <button class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#qrModal" (click)="applyVaccine('Td_refuerzo')">
            Aplicar
          </button>
        </td>
        <td class="col text-danger" *ngIf="CART_AMY.Td_refuerzo">
          <button class="btn btn-outline-success " data-bs-toggle="modal" data-bs-target="#seleccion"
            (click)="seleccionar(CART_AMY.Td_refuerzo)">
            Ver información
          </button>
        </td>
      </tr>
      <tr class="fila">
        <td class="col d-table-cell" data-bs-toggle="modal" data-bs-target="#dosis"
          (click)="dosis('Dosis Td Primera', 'Edad oprtuna:Dosis inicial')">
          Con esquema incompleto o no documentado - Primera
        </td>
        <td class="col text-danger" *ngIf="!CART_AMY.Td_primera">
          <button class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#qrModal" (click)="applyVaccine('Td_primera')">
            Aplicar
          </button>
        </td>
        <td class="col text-danger" *ngIf="CART_AMY.Td_primera">
          <button class="btn btn-outline-success " data-bs-toggle="modal" data-bs-target="#seleccion"
            (click)="seleccionar(CART_AMY.Td_primera)">
            Ver información
          </button>
        </td>
      </tr>
      <tr class="fila">
        <td class="col d-table-cell" data-bs-toggle="modal" data-bs-target="#dosis"
          (click)="dosis('Dosis Td Segunda', 'Edad oprtuna:1 mes después de la primera dosis')">
          Con esquema incompleto o no documentado - Segunda
        </td>
        <td class="col text-danger" *ngIf="!CART_AMY.Td_segunda">
          <button class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#qrModal" (click)="applyVaccine('Td_segunda')">
            Aplicar
          </button>
        </td>
        <td class="col text-danger" *ngIf="CART_AMY.Td_segunda">
          <button class="btn btn-outline-success " data-bs-toggle="modal" data-bs-target="#seleccion"
            (click)="seleccionar(CART_AMY.Td_segunda)">
            Ver información
          </button>
        </td>
      </tr>
      <tr class="fila">
        <td class="col d-table-cell" data-bs-toggle="modal" data-bs-target="#dosis"
          (click)="dosis('Dosis Td Tercera', 'Edad oprtuna:12 meses posteriores a la primera dosis')">
          Con esquema incompleto o no documentado - Tercera
        </td>
        <td class="col text-danger" *ngIf="!CART_AMY.Td_tercera">
          <button class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#qrModal" (click)="applyVaccine('Td_tercera')">
            Aplicar
          </button>
        </td>
        <td class="col text-danger" *ngIf="CART_AMY.Td_tercera">
          <button class="btn btn-outline-success " data-bs-toggle="modal" data-bs-target="#seleccion"
            (click)="seleccionar(CART_AMY.Td_tercera)">
            Ver información
          </button>
        </td>
      </tr>
      <tr class="fila">
        <td class="col d-table-cell" data-bs-toggle="modal" data-bs-target="#informacion"
          (click)="info('Influeza estacional', 'Influeza')">
          Influeza estacional
        </td>
        <td class="col d-table-cell" data-bs-toggle="modal" data-bs-target="#dosis"
          (click)="dosis('Dosis Influeza estacional Persona con factor de riesgo', 'Anual')">
          Personas con factores de riesgo
        </td>
        <td class="col text-danger" *ngIf="!CART_AMY.Influenza_factor_de_riesgo">
          <button class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#qrModal" (click)="applyVaccine('Influenza_factor_de_riesgo')">
            Aplicar
          </button>
        </td>
        <td class="col text-danger" *ngIf="CART_AMY.Influenza_factor_de_riesgo">
          <button class="btn btn-outline-success " data-bs-toggle="modal" data-bs-target="#seleccion"
            (click)="seleccionar(CART_AMY.Influenza_factor_de_riesgo)">
            Ver información
          </button>
        </td>
      </tr>
    </tbody>
  </table>
</div>

<app-modal *ngIf="modalVaccineInfo" [id]="'informacion'" [modal]="modalVaccineInfo" />
<app-modal *ngIf="modalVaccineDosis" [id]="'dosis'" [modal]="modalVaccineDosis" />

<div class="modal fade" id="seleccion" tabindex="-1" aria-labelledby="seleccionLabel" aria-hidden="true"
  *ngIf="vaccineSelected">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content text-dark">
      <div class="modal-header">
        <h1 class="modal-title fs-5 " id="seleccionLabel"> Vacuna: {{vaccineSelected.name}}</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body text-dark text-center">
        <p>Fecha: {{vaccineSelected.fecha}}</p>
        <p>Lote: {{vaccineSelected.lote}}</p>
        <p>Sede: {{vaccineSelected.sede}}</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
      </div>
    </div>
  </div>
</div>

<!-- Modal -->
<div class="modal fade" id="qrModal" tabindex="-1" aria-labelledby="qrModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="qrModalLabel">QR para aplicar Dosis</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body text-center">
        <qrcode [qrdata]="modalQR" [width]="256" [errorCorrectionLevel]="'M'"></qrcode>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#qrModal" data-bs-toggle="modal" data-bs-target="#qrModal" data-bs-dismiss="modal">Cerrar</button>
        <button type="button" class="btn btn-outline-success" data-bs-dismiss="modal"
          (click)="updateUserCard()">Verificar Aplicación</button>
      </div>
    </div>
  </div>
</div>
